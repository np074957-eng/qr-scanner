<!DOCTYPE html>
<html>
<head>
  <title>QR Scanner</title>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    body { 
      font-family: Arial; 
      text-align: center; 
      padding: 20px; 
    }
    #reader {
      width: 350px;
      margin: auto;
    }
  </style>
</head>

<body>
  <h2>QR Scanner Web</h2>
  <div id="reader"></div>

 

</body>

 <script>
    const URL = "https://script.google.com/macros/s/AKfycbxocP6k2e8mz5ayczAJwIFk3CfVaW5mIq4kUQqK1zbnnHqBSnCedon5uOy4Z7vC_kM7FA/exec";

    let lastData = "";
    let cooldown = 5000; // 2 detik cooldown
    let lastTime = 0;

if (qrCodeMessage) {
    let now = Date.now();

    // Cek agar tidak double scan
    if (qrCodeMessage !== lastData || now - lastScanTime > cooldown) {

        lastData = qrCodeMessage;
        lastScanTime = now;

        console.log("QR terbaca:", qrCodeMessage);

        sendToSheet(qrCodeMessage);

        // optional: bunyi beep
        beep();
    }
}

    function onScanSuccess(decodedText) {
        console.log("QR:", decodedText);

        // Kirim ke Google Sheet
        fetch(URL + "?kode=" + decodedText);

        // Bunyi beep
        const audio = new Audio("beep.mp3");
        audio.play();
    }

    const html5QrCode = new Html5Qrcode("reader");
    html5QrCode.start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      onScanSuccess
    );
  </script>


</html>


